<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to JPG Converter - Convert PDF Pages to Images</title>
    <meta name="description" content="Convert PDF pages to high-quality JPG images. Select specific pages, adjust quality settings, and download as individual files or ZIP archive.">
    <meta name="keywords" content="PDF to JPG, PDF converter, PDF to image, convert PDF pages, PDF tools">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <style>
        .ad-banner {
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            border: 2px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
        }
        .upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .upload-area.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        .page-item {
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .page-item.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- AdMob Top Banner -->
    <div class="ad-banner h-16 mb-4">
        <span>AdMob Banner Ad - Top Placement (728x90)</span>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center text-blue-600 hover:text-blue-700">
                        <i class="fas fa-arrow-left mr-2"></i>
                        <span class="font-medium">Back to Tools</span>
                    </a>
                </div>
                <h1 class="text-xl font-bold text-gray-900">PDF to JPG Converter</h1>
                <div class="w-24"></div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="flex flex-wrap -mx-4">
            <!-- Left AdMob Banner -->
            <div class="hidden lg:block w-32 px-4">
                <div class="ad-banner h-96 sticky top-8">
                    <span class="transform -rotate-90 whitespace-nowrap">AdMob Banner (160x600)</span>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1 px-4">
                <!-- Tool Description -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Convert PDF to JPG Images</h2>
                    <p class="text-gray-600 mb-4">Upload your PDF file and convert individual pages to high-quality JPG images. Select specific pages, choose quality settings, and download as individual files or a ZIP archive.</p>
                    <div class="flex flex-wrap gap-2">
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">Page Selection</span>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Quality Control</span>
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">Batch Download</span>
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm">ZIP Archive</span>
                    </div>
                </div>

                <!-- Upload Section -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Upload PDF File</h3>
                    <div id="uploadArea" class="upload-area bg-gray-50 rounded-lg p-8 text-center cursor-pointer">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <p class="text-lg text-gray-600 mb-2">Drag and drop your PDF file here</p>
                        <p class="text-sm text-gray-500 mb-4">or click to browse files</p>
                        <input type="file" id="fileInput" accept=".pdf" class="hidden">
                        <button id="browseBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            <i class="fas fa-folder-open mr-2"></i>Choose File
                        </button>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div id="settingsPanel" class="bg-white rounded-lg shadow-sm p-6 mb-6 hidden">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Conversion Settings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Page Selection -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Page Selection</label>
                            <select id="pageSelection" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="all">All Pages</option>
                                <option value="range">Page Range</option>
                                <option value="specific">Specific Pages</option>
                            </select>
                            <div id="pageRangeInput" class="mt-2 hidden">
                                <input type="text" id="pageRange" placeholder="e.g., 1-5 or 1,3,5" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <p class="text-xs text-gray-500 mt-1">Enter page numbers or ranges (e.g., 1-5, 7, 10-12)</p>
                            </div>
                        </div>

                        <!-- Quality Settings -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Output Quality</label>
                            <select id="qualitySelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="0.95">High Quality (95%)</option>
                                <option value="0.85" selected>Standard Quality (85%)</option>
                                <option value="0.70">Medium Quality (70%)</option>
                                <option value="0.50">Low Quality (50%)</option>
                            </select>
                        </div>
                    </div>

                    <button id="convertBtn" class="mt-6 w-full bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors font-medium">
                        <i class="fas fa-magic mr-2"></i>Convert to JPG
                    </button>
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="bg-white rounded-lg shadow-sm p-6 mb-6 hidden">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Conversion Progress</h3>
                    <div class="bg-gray-200 rounded-full h-4 mb-2">
                        <div id="progressBar" class="progress-bar bg-blue-600 h-4 rounded-full" style="width: 0%"></div>
                    </div>
                    <p id="progressText" class="text-sm text-gray-600">Preparing conversion...</p>
                </div>

                <!-- Preview Section -->
                <div id="previewSection" class="bg-white rounded-lg shadow-sm p-6 mb-6 hidden">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">PDF Preview</h3>
                        <span id="pageCount" class="text-sm text-gray-500"></span>
                    </div>
                    <div id="previewGrid" class="preview-grid"></div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="bg-white rounded-lg shadow-sm p-6 mb-6 hidden">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Converted Images</h3>
                        <div class="flex gap-2">
                            <button id="downloadAllBtn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                <i class="fas fa-download mr-2"></i>Download ZIP
                            </button>
                        </div>
                    </div>
                    <div id="resultsGrid" class="preview-grid"></div>
                </div>
            </div>

            <!-- Right AdMob Banner -->
            <div class="hidden lg:block w-32 px-4">
                <div class="ad-banner h-96 sticky top-8">
                    <span class="transform rotate-90 whitespace-nowrap">AdMob Banner (160x600)</span>
                </div>
            </div>
        </div>
    </div>

    <!-- AdMob Bottom Banner -->
    <div class="ad-banner h-16 mt-8">
        <span>AdMob Banner Ad - Bottom Placement (728x90)</span>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center">
                <p class="text-gray-600">&copy; 2024 Web Application Tools. All rights reserved.</p>
                <div class="mt-4 flex justify-center space-x-6">
                    <a href="#" class="text-gray-500 hover:text-gray-700">Privacy Policy</a>
                    <a href="#" class="text-gray-500 hover:text-gray-700">Terms of Service</a>
                    <a href="#" class="text-gray-500 hover:text-gray-700">Contact</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Set PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        class PDFToJPGConverter {
            constructor() {
                this.currentPDF = null;
                this.pages = [];
                this.convertedImages = [];
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                const uploadArea = document.getElementById('uploadArea');
                const fileInput = document.getElementById('fileInput');
                const browseBtn = document.getElementById('browseBtn');
                const pageSelection = document.getElementById('pageSelection');
                const convertBtn = document.getElementById('convertBtn');
                const downloadAllBtn = document.getElementById('downloadAllBtn');

                // File upload events
                uploadArea.addEventListener('click', () => fileInput.click());
                browseBtn.addEventListener('click', () => fileInput.click());
                fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // Drag and drop events
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });

                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.classList.remove('dragover');
                });

                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].type === 'application/pdf') {
                        this.loadPDF(files[0]);
                    }
                });

                // Settings events
                pageSelection.addEventListener('change', () => this.togglePageRangeInput());
                convertBtn.addEventListener('click', () => this.convertToJPG());
                downloadAllBtn.addEventListener('click', () => this.downloadAllAsZip());
            }

            handleFileSelect(event) {
                const file = event.target.files[0];
                if (file && file.type === 'application/pdf') {
                    this.loadPDF(file);
                } else {
                    alert('Please select a valid PDF file.');
                }
            }

            async loadPDF(file) {
                try {
                    this.showProgress('Loading PDF...', 10);
                    
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                    this.currentPDF = pdf;

                    this.showProgress('Processing pages...', 30);
                    await this.renderPreview();
                    
                    document.getElementById('settingsPanel').classList.remove('hidden');
                    document.getElementById('previewSection').classList.remove('hidden');
                    document.getElementById('pageCount').textContent = `${pdf.numPages} pages`;
                    
                    this.hideProgress();
                } catch (error) {
                    console.error('Error loading PDF:', error);
                    alert('Error loading PDF file. Please try again.');
                    this.hideProgress();
                }
            }

            async renderPreview() {
                const previewGrid = document.getElementById('previewGrid');
                previewGrid.innerHTML = '';
                this.pages = [];

                for (let pageNum = 1; pageNum <= this.currentPDF.numPages; pageNum++) {
                    const page = await this.currentPDF.getPage(pageNum);
                    const viewport = page.getViewport({ scale: 0.5 });
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;

                    const pageDiv = document.createElement('div');
                    pageDiv.className = 'page-item bg-white rounded-lg shadow-sm p-4 cursor-pointer';
                    pageDiv.innerHTML = `
                        <div class="text-center">
                            <img src="${canvas.toDataURL()}" alt="Page ${pageNum}" class="w-full h-auto rounded mb-2">
                            <p class="text-sm font-medium text-gray-700">Page ${pageNum}</p>
                            <input type="checkbox" class="page-checkbox mt-2" data-page="${pageNum}" checked>
                        </div>
                    `;

                    pageDiv.addEventListener('click', (e) => {
                        if (e.target.type !== 'checkbox') {
                            const checkbox = pageDiv.querySelector('.page-checkbox');
                            checkbox.checked = !checkbox.checked;
                        }
                        this.updatePageSelection(pageDiv);
                    });

                    previewGrid.appendChild(pageDiv);
                    this.pages.push({ pageNum, canvas: canvas.cloneNode(true) });
                }
            }

            updatePageSelection(pageDiv) {
                const checkbox = pageDiv.querySelector('.page-checkbox');
                if (checkbox.checked) {
                    pageDiv.classList.add('selected');
                } else {
                    pageDiv.classList.remove('selected');
                }
            }

            togglePageRangeInput() {
                const pageSelection = document.getElementById('pageSelection').value;
                const pageRangeInput = document.getElementById('pageRangeInput');
                
                if (pageSelection === 'range' || pageSelection === 'specific') {
                    pageRangeInput.classList.remove('hidden');
                } else {
                    pageRangeInput.classList.add('hidden');
                }
            }

            async convertToJPG() {
                const pageSelection = document.getElementById('pageSelection').value;
                const quality = parseFloat(document.getElementById('qualitySelect').value);
                let selectedPages = [];

                if (pageSelection === 'all') {
                    selectedPages = this.pages.map(p => p.pageNum);
                } else if (pageSelection === 'range' || pageSelection === 'specific') {
                    const pageRange = document.getElementById('pageRange').value;
                    selectedPages = this.parsePageRange(pageRange);
                } else {
                    // Use checkbox selection
                    const checkboxes = document.querySelectorAll('.page-checkbox:checked');
                    selectedPages = Array.from(checkboxes).map(cb => parseInt(cb.dataset.page));
                }

                if (selectedPages.length === 0) {
                    alert('Please select at least one page to convert.');
                    return;
                }

                this.showProgress('Converting pages...', 0);
                this.convertedImages = [];

                for (let i = 0; i < selectedPages.length; i++) {
                    const pageNum = selectedPages[i];
                    const progress = ((i + 1) / selectedPages.length) * 100;
                    this.showProgress(`Converting page ${pageNum}...`, progress);

                    try {
                        const page = await this.currentPDF.getPage(pageNum);
                        const viewport = page.getViewport({ scale: 2.0 });
                        
                        const canvas = document.createElement('canvas');
                        const context = canvas.getContext('2d');
                        canvas.width = viewport.width;
                        canvas.height = viewport.height;

                        await page.render({
                            canvasContext: context,
                            viewport: viewport
                        }).promise;

                        const imageData = canvas.toDataURL('image/jpeg', quality);
                        this.convertedImages.push({
                            pageNum,
                            imageData,
                            filename: `page_${pageNum}.jpg`
                        });
                    } catch (error) {
                        console.error(`Error converting page ${pageNum}:`, error);
                    }
                }

                this.showResults();
                this.hideProgress();
            }

            parsePageRange(rangeString) {
                const pages = [];
                const parts = rangeString.split(',');
                
                for (const part of parts) {
                    const trimmed = part.trim();
                    if (trimmed.includes('-')) {
                        const [start, end] = trimmed.split('-').map(n => parseInt(n.trim()));
                        if (start && end && start <= end) {
                            for (let i = start; i <= Math.min(end, this.currentPDF.numPages); i++) {
                                pages.push(i);
                            }
                        }
                    } else {
                        const pageNum = parseInt(trimmed);
                        if (pageNum && pageNum <= this.currentPDF.numPages) {
                            pages.push(pageNum);
                        }
                    }
                }
                
                return [...new Set(pages)].sort((a, b) => a - b);
            }

            showResults() {
                const resultsGrid = document.getElementById('resultsGrid');
                resultsGrid.innerHTML = '';

                this.convertedImages.forEach(({ pageNum, imageData, filename }) => {
                    const resultDiv = document.createElement('div');
                    resultDiv.className = 'bg-white rounded-lg shadow-sm p-4';
                    resultDiv.innerHTML = `
                        <div class="text-center">
                            <img src="${imageData}" alt="Page ${pageNum}" class="w-full h-auto rounded mb-2">
                            <p class="text-sm font-medium text-gray-700 mb-2">${filename}</p>
                            <button class="download-btn bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition-colors">
                                <i class="fas fa-download mr-1"></i>Download
                            </button>
                        </div>
                    `;

                    const downloadBtn = resultDiv.querySelector('.download-btn');
                    downloadBtn.addEventListener('click', () => this.downloadImage(imageData, filename));

                    resultsGrid.appendChild(resultDiv);
                });

                document.getElementById('resultsSection').classList.remove('hidden');
            }

            downloadImage(imageData, filename) {
                const link = document.createElement('a');
                link.href = imageData;
                link.download = filename;
                link.click();
            }

            async downloadAllAsZip() {
                if (this.convertedImages.length === 0) {
                    alert('No images to download.');
                    return;
                }

                const zip = new JSZip();
                
                for (const { imageData, filename } of this.convertedImages) {
                    const base64Data = imageData.split(',')[1];
                    zip.file(filename, base64Data, { base64: true });
                }

                const zipBlob = await zip.generateAsync({ type: 'blob' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(zipBlob);
                link.download = 'converted_pages.zip';
                link.click();
            }

            showProgress(message, percentage) {
                document.getElementById('progressSection').classList.remove('hidden');
                document.getElementById('progressText').textContent = message;
                document.getElementById('progressBar').style.width = `${percentage}%`;
            }

            hideProgress() {
                document.getElementById('progressSection').classList.add('hidden');
            }
        }

        // Initialize the converter when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new PDFToJPGConverter();
        });
    </script>
</body>
</html>
